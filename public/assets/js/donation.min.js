async function initMap(){var a,b;await getPosition().then(c=>{a={lat:c.coords.latitude,lng:c.coords.longitude},b=10,window.latInput=c.coords.latitude,window.lngInput=c.coords.longitude}).catch(c=>{console.error(c.message),a={lat:-25.363,lng:131.044},b=4});var c=new google.maps.Map(document.getElementById("map"),{zoom:b,center:a}),d=new google.maps.InfoWindow({content:"<form class=\"donation\"><div class=\"form-group field\"><label class=\"label\" for=\"Description\">Description</label><textarea type=\"text\" class=\"form-control textarea is-primary is-small\" rows=\"4\" id=\"description-input\" placeholder=\"Eg. Blankets, books...\"></textarea></div><div class=\"form-group field\"><label class=\"label\" for=\"categories\">Category</label><div class=\"control is-expanded\"><div class=\"select is-small\"><select id=\"categories\" value=\"category\"> <!--Drop down to what category the items are in--><option>Food</option><option>Clothes</option><option>Books</option><option>Homeware</option><option>Help</option></select></div></div></div><button type=\"submit\" class=\"donationCreation button is-primary\">Create Donation</button></form>"}),e=new google.maps.InfoWindow({content:"<p>Click to post new donation!</p>"}),f=new google.maps.Marker({position:a,map:c,draggable:!0,title:"Donation location"});e.open(c,f),f.addListener("click",function(){e.close(),d.open(c,f)}),google.maps.event.addListener(f,"dragend",function(a){window.latInput=a.latLng.lat(),window.lngInput=a.latLng.lng()})}function getPosition(){return new Promise((a,b)=>{navigator.geolocation.getCurrentPosition(a,b)})}$(document).on("submit",".donation",function(a){var b=$("textarea#description-input");a.preventDefault();var c={description:b.val().trim(),category:$("#categories").val(),lat:latInput,lng:lngInput};c.description&&(console.log(c),createDonation(c.description,c.category,c.lat,c.lng),createHistory(c.description,c.category))});function createHistory(a,b){$.post("/api/donationHistory",{description:a,category:b}).then(function(){console.log("redirecting place"),window.location.replace("/user")}).catch(function(a){console.log(a)})}function createDonation(a,b,c,d){$.post("/api/donation",{description:a,category:b,lat:c,lng:d}).then(function(){console.log("success"),window.location.replace("/user")}).catch(function(a){console.log(a)})}