var center,zoom,userSelection="";$(document).on("click",".map-donation",function(){var a={lat:$(this).parent().parent().data("lat"),lng:$(this).parent().parent().data("lng")};window.location.replace("/user?lat="+a.lat+"&lng="+a.lng)}),$(document).on("click",".viewIcons",function(a){switch(a.target.text.trim()){case"All":userSelection="";break;case"Charities":userSelection="Charity";break;case"Events":userSelection="Event";break;case"Donations":userSelection="Donation";break;case"- Food":userSelection="Food";break;case"- Clothes":userSelection="Clothes";break;case"- Books":userSelection="Books";break;case"- Homeware":userSelection="Homeware";break;case"- Help":userSelection="Help";break;default:return userSelection="";}""===userSelection?$("#selected-filter").text("Filter"):$("#selected-filter").text(userSelection),initMap()});function getMarkers(a){$.get("/api/markers",function(){}).then(function(b){var c=b.donation;c=c.filter(function(a){return""===userSelection?a:userSelection===a.category?a:"Donation"===userSelection?a:void 0});var d=b.charity;d=d.filter(function(a){if(""!==userSelection)switch("Charity"){case userSelection:return a;default:return;}return a});var e=b.event;e=e.filter(function(a){if(""!==userSelection)switch("Event"){case userSelection:return a;default:return;}return a});var f={donation:c,charity:d,event:e};a(f)})}function initMap(a){var b=window.location.search,c=new URLSearchParams(b),d=c.get("lat"),e=c.get("lng"),a={lat:parseFloat(d),lng:parseFloat(e)};Number.isNaN(a.lat)&&Number.isNaN(a.lng)?(center={lat:-26.363,lng:135.044},zoom=5):(center=a,zoom=15);var f=new google.maps.StyledMapType([{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}],{name:"Night Mode"}),g=new google.maps.Map(document.getElementById("map"),{zoom:zoom,center:center,mapTypeControlOptions:{mapTypeIds:["roadmap","styled_map"]}});g.mapTypes.set("styled_map",f),g.setMapTypeId("roadmap");var h={Food:{icon:"http://maps.google.com/mapfiles/kml/pal2/icon63.png"},Homeware:{icon:"http://maps.google.com/mapfiles/kml/pal2/icon28.png"},Clothes:{icon:"http://maps.google.com/mapfiles/kml/pal2/icon57.png"},Help:{icon:"http://maps.google.com/mapfiles/kml/pal2/icon7.png"},Event:{icon:"http://maps.google.com/mapfiles/kml/pal2/icon13.png"},Charity:{icon:"http://maps.google.com/mapfiles/kml/pal2/icon10.png"},Books:{icon:"http://maps.google.com/mapfiles/kml/pal2/icon31.png"}},i=function(a){getMarkers(function(b){var c=b.donation,d=b.charity,e=b.event;a(c.map(function(a){var b={lat:parseFloat(a.lat),lng:parseFloat(a.lng)};return new google.maps.Marker({position:b,icon:h[a.category].icon,customInfo:{category:a.category,description:a.description,user:a.User.firstName,phone:a.User.phoneNumber,email:a.User.email}})})),a(d.map(function(a){var b={lat:parseFloat(a.lat),lng:parseFloat(a.lng)};return new google.maps.Marker({position:b,icon:h.Charity.icon,customInfo:{description:a.description,name:a.name,phone:a.phoneNumber,email:a.email}})})),a(e.map(function(a){var b={lat:parseFloat(a.lat),lng:parseFloat(a.lng)};return new google.maps.Marker({position:b,icon:h.Event.icon,customInfo:{title:a.title,description:a.description,name:a.Charity.name,phone:a.Charity.phoneNumber,email:a.Charity.email}})}))})},j=new google.maps.InfoWindow;(async function(){await i(function(b){b.forEach(b=>a.addMarker(b));for(var c=0;c<b.length;c++)if(b[c].customInfo.category){var d=b[c];google.maps.event.addListener(d,"click",function(){var a=this.customInfo;j.setContent("<strong>DONATION</strong><br><Strong>Category:</Strong> "+a.category+"<br><Strong>Description:</Strong> "+a.description+"<br><Strong>Donator:</Strong> "+a.user+"<br><Strong>Phone:</Strong> "+a.phone+"<br><Strong>Email:</Strong> "+a.email),j.open(this.getMap(),this)})}else if(b[c].customInfo.title){var d=b[c];google.maps.event.addListener(d,"click",function(){var a=this.customInfo;j.setContent("<strong>EVENT</strong><br><Strong>Title:</Strong> "+a.title+"<br><Strong>Description:</Strong> "+a.description+"<br><Strong>Charity:</Strong> "+a.name+"<br><Strong>Phone:</Strong> "+a.phone+"<br><Strong>Email:</Strong> "+a.email),j.open(this.getMap(),this)})}else{var d=b[c];google.maps.event.addListener(d,"click",function(){var a=this.customInfo;j.setContent("<strong>CHARITY</strong><br><Strong>Name:</Strong> "+a.name+"<br><Strong>Description:</Strong> "+a.description+"<br><Strong>Phone:</Strong> "+a.phone+"<br><Strong>Email:</Strong> "+a.email),j.open(this.getMap(),this)})}});var a=new MarkerClusterer(g,[],{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})})()}