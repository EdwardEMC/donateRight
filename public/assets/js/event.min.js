async function initMap(){var a,b;await getPosition().then(c=>{a={lat:c.coords.latitude,lng:c.coords.longitude},b=10,window.latInput=c.coords.latitude,window.lngInput=c.coords.longitude}).catch(c=>{console.error(c.message),a={lat:-25.363,lng:131.044},b=4});var c=new google.maps.Map(document.getElementById("map"),{zoom:b,center:a}),d=new google.maps.InfoWindow({content:"<form class=\"event\"><div class=\"form-group field\"><label class=\"label\" for=\"Title\">Title</label><p class=\"control is-expanded\"><input class=\"input\" type=\"text\" id=\"title-input\" required placeholder=\"Event name\"></p></div><div class=\"form-group field\"><label class=\"label\" for=\"Description\">Description</label><textarea type=\"text\" class=\"form-control textarea is-primary is-small\" required rows=\"4\" id=\"description-input\" placeholder=\"Eg. Canned food collection for supporting flood victims\"></textarea></div><button type=\"submit\" class=\"eventCreation button is-primary\">Create Event</button></form>"}),e=new google.maps.InfoWindow({content:"<p>Click to post new event!</p>"}),f=new google.maps.Marker({position:a,map:c,draggable:!0,title:"Event location"});e.open(c,f),f.addListener("click",function(){e.close(),d.open(c,f)}),google.maps.event.addListener(f,"dragend",function(a){window.latInput=a.latLng.lat(),window.lngInput=a.latLng.lng()})}function getPosition(){return new Promise((a,b)=>{navigator.geolocation.getCurrentPosition(a,b)})}$(document).on("submit",".event",function(a){var b=$("textarea#description-input"),c=$("#title-input");a.preventDefault();var d={title:c.val().trim(),description:b.val().trim(),lat:latInput,lng:lngInput};d.description&&(console.log(d),createEvent(d.description,d.title,d.lat,d.lng),createHistory(d.description,d.title))});function createHistory(a,b){$.post("/api/eventHistory",{title:b,description:a}).then(function(){window.location.replace("/user")}).catch(function(a){console.log(a)})}function createEvent(a,b,c,d){$.post("/api/event",{title:b,description:a,lat:c,lng:d}).then(function(){console.log("success"),window.location.replace("/user")}).catch(function(a){console.log(a)})}